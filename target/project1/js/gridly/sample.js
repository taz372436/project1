// Generated by CoffeeScript 1.9.3
(function() {
  $(function() {
	/*
    var brick;
    brick = "<div class='brick small'><div class='contentDiv'><span class='fontSpan'>张三</span></div><a class='delete' href='javascript:void(0)'>1</a></div>";
    $(document).on("click touchend", ".gridly .brick", function(event) {
      var $this, size;
      event.preventDefault();
      event.stopPropagation();
      $this = $(this);
      $this.toggleClass('small');
      $this.toggleClass('large');
      if ($this.hasClass('small')) {
        size = 140;
      }
      if ($this.hasClass('large')) {
        size = 300;
      }
      $this.data('width', size);
      $this.data('height', size);
      return $('.gridly').gridly('layout');
    });
    $(document).on("click", ".gridly .delete", function(event) {
      var $this;
      event.preventDefault();
      event.stopPropagation();
      $this = $(this);
      $this.closest('.brick').remove();
      return $('.gridly').gridly('layout');
    });
    $(document).on("click", ".add", function(event) {
      event.preventDefault();
      event.stopPropagation();
      $('.gridly').append(brick);
      return $('.gridly').gridly();
    });*/
    $(document).on("click", ".add", function(event) {
    	var objJson = [];
    	var arr = $(".gridly").children("div");
	    for(var i =0; i < arr.length; i++){
	    	var id = $(arr[i]).attr("g_id");
	    	var sort = $(arr[i]).find("a").html();
	    	objJson.push(jQuery.parseJSON('{"guestSort":"' + sort + '","id":"' + id + '"}'));
	    }
	    var json = JSON.stringify(objJson);
		var url = "/visa/zzlgl/templateCode/updGues.html";
		$.ajax({
			url : url,
			type : 'POST',
			async : false,
			dataType:"json",
			data:"json="+json,
			success : function(data) {
				if (data == "1") {
					layer.msg('保存成功!');
					window.parent.reclareLod();
				} else {
					layer.msg('保存失败!');
				}
			}
		}); 
    });
    //拖动后回调
    var reordered =function($elements){
	    var arr = $elements;
	    for(var i =0; i < arr.length; i++){
	    	$(arr[i]).find("a").html((i+1));
	    }
    };
    //reordering拖动前回调，reordered拖动后回调
    return $('.gridly').gridly({
    	callbacks:{reordered: reordered }
    });
  });

}).call(this);
